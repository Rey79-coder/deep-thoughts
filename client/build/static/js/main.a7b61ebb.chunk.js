(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{81:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a,c,r,s,i,o,l,d,u,j,h,b=n(3),m=n.n(b),O=n(62),g=n.n(O),x=(n(81),n(16)),f=n(71),p=n(100),v=n(101),w=n(99),y=n(70),N=n(12),k=n(10),S=n(15),C=n.n(S),_=n(27),$=n(36),T=n(13),I=n(105),A=n(20),B=n(102),W=Object(B.a)(a||(a=Object(A.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),D=Object(B.a)(c||(c=Object(A.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),L=Object(B.a)(r||(r=Object(A.a)(["\n  mutation addFriend($id: ID!) {\n    addFriend(friendId: $id) {\n      _id\n      username\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),R=Object(B.a)(s||(s=Object(A.a)(["\n  mutation addThought($thoughtText: String!) {\n    addThought(thoughtText: $thoughtText) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n      }\n    }\n  }\n"]))),q=Object(B.a)(i||(i=Object(A.a)(["\n  mutation addReaction($thoughtId: ID!, $reactionBody: String!) {\n    addReaction(thoughtId: $thoughtId, reactionBody: $reactionBody) {\n      _id\n      reactionCount\n      reactions {\n        _id\n        reactionBody\n        createdAt\n        username\n      }\n    }\n  }\n"]))),U=n(63),F=n(64),E=n(53),Y=new(function(){function e(){Object(U.a)(this,e)}return Object(F.a)(e,[{key:"getProfile",value:function(){return Object(E.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(E.a)(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),P=n(1),Q=function(e){var t=Object(b.useState)({email:"",password:""}),n=Object(T.a)(t,2),a=n[0],c=n[1],r=Object(I.a)(W),s=Object(T.a)(r,2),i=s[0],o=s[1].error,l=function(e){var t=e.target,n=t.name,r=t.value;c(Object(x.a)(Object(x.a)({},a),{},Object($.a)({},n,r)))},d=function(){var e=Object(_.a)(C.a.mark((function e(t){var n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,i({variables:Object(x.a)({},a)});case 4:n=e.sent,c=n.data,Y.login(c.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(P.jsx)("div",{className:"col-12 col-md-6",children:Object(P.jsxs)("div",{className:"card",children:[Object(P.jsx)("h4",{className:"card-header",children:"Login"}),Object(P.jsx)("div",{className:"card-body",children:Object(P.jsxs)("form",{onSubmit:d,children:[Object(P.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:a.email,onChange:l}),Object(P.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:a.password,onChange:l}),Object(P.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"}),o&&Object(P.jsx)("div",{children:"Login failed"})]})})]})})})},J=function(){return Object(P.jsx)("div",{children:"Oops, we couldn't find that page."})},M=n(103),z=Object(B.a)(o||(o=Object(A.a)(["\n  query thoughts($username: String) {\n    thoughts(username: $username) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"]))),H=Object(B.a)(l||(l=Object(A.a)(["\nquery thought($id: ID!) {\n  thought(_id: $id) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"]))),V=Object(B.a)(d||(d=Object(A.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n      thoughts {\n        _id\n        thoughtText\n        createdAt\n        reactionCount\n      }\n    }\n  }\n"]))),G=Object(B.a)(u||(u=Object(A.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      thoughts {\n        _id\n        thoughtText\n        createdAt\n        reactionCount\n        reactions {\n          _id\n          createdAt\n          reactionBody\n          username\n        }\n      }\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),K=Object(B.a)(j||(j=Object(A.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),X=(Object(B.a)(h||(h=Object(A.a)(["\n  mutation addReaction($thoughtId: ID!, $reactionBody: String!) {\n    addReaction(thoughtId: $thoughtId, reactionBody: $reactionBody) {\n      _id\n      reactionCount\n      reactions {\n        _id\n        reactionBody\n        createdAt\n        username\n      }\n    }\n  }\n"]))),function(e){var t=e.reactions;return Object(P.jsxs)("div",{className:"card mb-3",children:[Object(P.jsx)("div",{className:"card-header",children:Object(P.jsx)("span",{className:"text-light",children:"Reactions"})}),Object(P.jsx)("div",{className:"card-body",children:t&&t.map((function(e){return Object(P.jsxs)("p",{className:"pill mb-3",children:[e.reactionBody," ","// ",Object(P.jsxs)(N.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},children:[e.username," on ",e.createdAt]})]},e._id)}))})]})}),Z=function(e){var t=e.thoughtId,n=Object(b.useState)(""),a=Object(T.a)(n,2),c=a[0],r=a[1],s=Object(b.useState)(0),i=Object(T.a)(s,2),o=i[0],l=i[1],d=Object(I.a)(q),u=Object(T.a)(d,2),j=u[0],h=u[1].error,m=function(){var e=Object(_.a)(C.a.mark((function e(n){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,j({variables:{reactionBody:c,thoughtId:t}});case 4:r(""),l(0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{children:[Object(P.jsxs)("p",{className:"m-0 ".concat(280===o||h?"text-error":""),children:["Character Count: ",o,"/280",h&&Object(P.jsx)("span",{className:"ml-2",children:"Something went wrong..."})]}),Object(P.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-stretch",onSubmit:m,children:[Object(P.jsx)("textarea",{placeholder:"Leave a reaction to this thought...",value:c,className:"form-input col-12 col-md-9",onChange:function(e){e.target.value.length<=280&&(r(e.target.value),l(e.target.value.length))}}),Object(P.jsx)("button",{className:"btn col-12 col-md-3",type:"submit",children:"Submit"})]}),h&&Object(P.jsx)("div",{children:"Something went wrong..."})]})},ee=function(e){var t=Object(k.g)().id;console.log(t);var n=Object(M.a)(H,{variables:{id:t}}),a=n.loading,c=n.data,r=(null===c||void 0===c?void 0:c.thought)||{};return a?Object(P.jsx)("div",{children:"Loading..."}):Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"card mb-3",children:[Object(P.jsxs)("p",{className:"card-header",children:[Object(P.jsx)("span",{style:{fontWeight:700},className:"text-light",children:r.username})," ","thought on ",r.createdAt]}),Object(P.jsx)("div",{className:"card-body",children:Object(P.jsx)("p",{children:r.thoughtText})})]}),r.reactionCount>0&&Object(P.jsx)(X,{reactions:r.reactions}),Y.loggedIn()&&Object(P.jsx)(Z,{thoughtId:r._id})]})},te=n(59),ne=function(){var e=Object(b.useState)(""),t=Object(T.a)(e,2),n=t[0],a=t[1],c=Object(b.useState)(0),r=Object(T.a)(c,2),s=r[0],i=r[1],o=Object(I.a)(R,{update:function(e,t){var n=t.data.addThought;try{var a=e.readQuery({query:z}).thoughts;e.writeQuery({query:z,data:{thoughts:[n].concat(Object(te.a)(a))}})}catch(r){console.error(r)}var c=e.readQuery({query:G}).me;e.writeQuery({query:G,data:{me:Object(x.a)(Object(x.a)({},c),{},{thoughts:[].concat(Object(te.a)(c.thoughts),[n])})}})}}),l=Object(T.a)(o,2),d=l[0],u=l[1].error,j=function(){var e=Object(_.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,d({variables:{thoughtText:n}});case 4:a(""),i(0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{children:[Object(P.jsxs)("p",{className:"m-0 ".concat(280===s||u?"text-error":""),children:["Character Count: ",s,"/280",u&&Object(P.jsx)("span",{className:"ml-2",children:"Something went wrong..."})]}),Object(P.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-stretch",onSubmit:j,children:["                ",Object(P.jsx)("textarea",{placeholder:"Here's a new thought...",value:n,className:"form-input col-12 col-md-9",onChange:function(e){e.target.value.length<=280&&(a(e.target.value),i(e.target.value.length))}}),Object(P.jsx)("button",{className:"btn col-12 col-md-3",type:"submit",children:"Submit"})]})]})},ae=function(e){var t=e.thoughts,n=e.title;return t.length?Object(P.jsxs)("div",{children:[Object(P.jsx)("h3",{children:n}),t&&t.map((function(e){return Object(P.jsxs)("div",{className:"card mb-3",children:[Object(P.jsxs)("p",{className:"card-header",children:[Object(P.jsx)(N.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},className:"text-light",children:e.username})," ","thought on ",e.createdAt]}),Object(P.jsx)("div",{className:"card-body",children:Object(P.jsxs)(N.b,{to:"/thought/".concat(e._id),children:[Object(P.jsx)("p",{children:e.thoughtText}),Object(P.jsxs)("p",{className:"mb-0",children:["Reactions: ",e.reactionCount," || Click to"," ",e.reactionCount?"see":"start"," the discussion!"]})]})})]},e._id)}))]}):Object(P.jsx)("h3",{children:"No Thoughts Yet"})},ce=function(e){var t=e.friendCount,n=e.username,a=e.friends;return a&&a.length?Object(P.jsxs)("div",{children:[Object(P.jsxs)("h5",{children:[n,"'s ",t," ",1===t?"friend":"friends"]}),a.map((function(e){return Object(P.jsx)("button",{className:"btn w-100 display-block mb-2",children:Object(P.jsx)(N.b,{to:"/profile/".concat(e.username),children:e.username})},e._id)}))]}):Object(P.jsxs)("p",{className:"bg-dark text-light p-3",children:[n,", make some friends!"]})},re=function(){var e=Object(k.g)().username,t=Object(I.a)(L),n=Object(T.a)(t,1)[0],a=Object(M.a)(e?V:G,{variables:{username:e}}),c=a.loading,r=a.data,s=(null===r||void 0===r?void 0:r.me)||(null===r||void 0===r?void 0:r.user)||{};if(Y.loggedIn()&&Y.getProfile().data.username===e)return Object(P.jsx)(k.a,{to:"/profile"});if(c)return Object(P.jsx)("div",{children:"Loading..."});if(!(null===s||void 0===s?void 0:s.username))return Object(P.jsx)("h4",{children:"You need to be logged in to see this page. Use the navigation links above to sign up or log in!"});var i=function(){var e=Object(_.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({variables:{id:s._id}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"flex-row mb-3",children:[Object(P.jsxs)("h2",{className:"bg-dark text-secondary p-3 display-inline-block",children:["Viewing ",e?"".concat(s.username,"'s"):"your"," profile."]}),e&&Object(P.jsx)("button",{className:"btn ml-auto",onClick:i,children:"Add Friend"})]}),Object(P.jsxs)("div",{className:"flex-row justify-space-between mb-3",children:[Object(P.jsx)("div",{className:"col-12 mb-3 col-lg-8",children:Object(P.jsx)(ae,{thoughts:s.thoughts,title:"".concat(s.username,"'s thoughts...")})}),Object(P.jsx)("div",{className:"col-12 col-lg-3 mb-3",children:Object(P.jsx)(ce,{username:s.username,friendCount:s.friendCount,friends:s.friends})})]}),Object(P.jsx)("div",{className:"mb-3",children:!e&&Object(P.jsx)(ne,{})})]})},se=function(){var e=Object(b.useState)({username:"",email:"",password:""}),t=Object(T.a)(e,2),n=t[0],a=t[1],c=Object(I.a)(D),r=Object(T.a)(c,2),s=r[0],i=r[1].error,o=function(e){var t=e.target,c=t.name,r=t.value;a(Object(x.a)(Object(x.a)({},n),{},Object($.a)({},c,r)))},l=function(){var e=Object(_.a)(C.a.mark((function e(t){var a,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,s({variables:Object(x.a)({},n)});case 4:a=e.sent,c=a.data,Y.login(c.addUser.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(P.jsx)("div",{className:"col-12 col-md-6",children:Object(P.jsxs)("div",{className:"card",children:[Object(P.jsx)("h4",{className:"card-header",children:"Sign Up"}),Object(P.jsx)("div",{className:"card-body",children:Object(P.jsxs)("form",{onSubmit:l,children:[Object(P.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"username",id:"username",value:n.username,onChange:o}),Object(P.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:n.email,onChange:o}),Object(P.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:n.password,onChange:o}),Object(P.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"}),i&&Object(P.jsx)("div",{children:"Sign up failed"})]})})]})})})},ie=function(){return Object(P.jsx)("header",{className:"bg-secondary mb-4 py-2 flex-row align-center",children:Object(P.jsxs)("div",{className:"container flex-row justify-space-between-lg justify-center align-center",children:[Object(P.jsx)(N.b,{to:"/",children:Object(P.jsx)("h1",{children:"Deep Thoughts"})}),Object(P.jsx)("nav",{className:"text-center",children:Y.loggedIn()?Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.b,{to:"/profile",children:"Me"}),Object(P.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),Y.logout()},children:"Logout"})]}):Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.b,{to:"/login",children:"Login"}),Object(P.jsx)(N.b,{to:"/signup",children:"Signup"})]})})]})})},oe=function(){return Object(P.jsx)("footer",{className:"w-100 mt-auto bg-secondary p-4",children:Object(P.jsx)("div",{className:"container",children:"\xa92021 by Cats From Around The World"})})},le=function(){var e=Object(M.a)(z),t=e.loading,n=e.data,a=Object(M.a)(K).data,c=(null===n||void 0===n?void 0:n.thoughts)||[];console.log(c);var r=Y.loggedIn();return Object(P.jsx)("main",{children:Object(P.jsxs)("div",{className:"flex-row justify-space-between",children:[r&&Object(P.jsx)("div",{className:"col-12 mb-3",children:Object(P.jsx)(ne,{})}),Object(P.jsx)("div",{className:"col-12 mb-3 ".concat(r&&"col-lg-8"),children:t?Object(P.jsx)("div",{children:"Loading..."}):Object(P.jsx)(ae,{thoughts:c,title:"Some Feed for Thought(s)..."})}),r&&a?Object(P.jsx)("div",{className:"col-12 col-lg-3 mb-3",children:Object(P.jsx)(ce,{username:a.me.username,friendCount:a.me.friendCount,friends:a.me.friends})}):null]})})},de=Object(f.a)({uri:"/graphql"}),ue=Object(y.a)((function(e,t){var n=t.headers,a=localStorage.getItem("id_token");return{headers:Object(x.a)(Object(x.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})),je=new p.a({link:ue.concat(de),cache:new v.a});var he=function(){return Object(P.jsx)(w.a,{client:je,children:Object(P.jsx)(N.a,{children:Object(P.jsxs)("div",{className:"flex-column justify-flex-start min-100-vh",children:[Object(P.jsx)(ie,{}),Object(P.jsx)("div",{className:"container",children:Object(P.jsxs)(k.d,{children:[Object(P.jsx)(k.b,{exact:!0,path:"/",component:le}),Object(P.jsx)(k.b,{exact:!0,path:"/login",component:Q}),Object(P.jsx)(k.b,{exact:!0,path:"/signup",component:se}),Object(P.jsx)(k.b,{exact:!0,path:"/profile/:username?",component:re}),Object(P.jsx)(k.b,{exact:!0,path:"/thought/:id",component:ee}),Object(P.jsx)(k.b,{component:J})]})}),Object(P.jsx)(oe,{})]})})})},be=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function me(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}g.a.render(Object(P.jsx)(m.a.StrictMode,{children:Object(P.jsx)(he,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");be?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):me(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):me(t,e)}))}}()}},[[92,1,2]]]);
//# sourceMappingURL=main.a7b61ebb.chunk.js.map